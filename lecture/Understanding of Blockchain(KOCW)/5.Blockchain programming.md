# 1. 블록체인 응용의 구조

### 블록체인과 스마트 계약이 backend server의 역할을 담당

- 데이터베이스 → 블록체인
- WAS의 business logic → 스마트 계약
- Frontend 단에서 블록체인의 내용을 액세스하고, 스마트 계약을 실행시킬 수 있는 기능이 필요 → web3.js → HTML과 연동하여 browser에 출력

- 블록체인 개발을 위해 사용할 수 있는 자바스크립트 모듈 → web3.js
- 프론트엔드단은 web3.js를 통해서 개발을 하게 된다.
- 이더리움의 노드들이 지원하는 가장 low-level의 인터페이스를 보통 json-rpc라고 하는데, 이 web3.js를 json-rpc로 바꿔주는 것이 web3 provider - 보통 브라우저에 메타마스크 등을 가지고 설치를 하게 된다.

# 2. Solidity를 이용한 스마트 계약 구현

## Solidity 프로그래밍 언어 소개

- 스마트 계약을 구현할 때 사용하는 contract 기반의 high-level 프로그래밍 언어
- C++와 JavaScript의 영향을 많이 받은 언어
- 이더리움 가상 머신(EVM)에서 실행되는 것을 목표로 설계된 언어
- 데이터 타입 지원, 계승(inheritance) 지원, 복잡한 사용자 정의 데이터 타입 지원
- 전자 투표나 온라인 경매, crowd funding 등 다양한 목적의 스마트 계약을 생성할 때 사용 가능

## Solidity 프로그램의 기본적인 문법

### Pragma

- 소스 코드의 Solidity 버전
- pragma solidity ≥ 0.5.0;
    - 버전 0.5.0 이상에서만 컴파일됨을 표시

### Contract

- 프로그램 코드(function)와 데이터(state)로 구성
- 이더리움 블록체인의 특정 주소에 저장

### 실행방법

- Remix IDE를 이용

## 상태변수(state variable)와 지역 변수(local variable)

### 상태 변수

- Contract 저장소에 값이 영원히 저장되는 변수
- 이용료가 비싸다.

### 지역 변수

- 함수가 실행될 때만 값이 유지되는 변수
- 이용료가 싸다.

## 변수의 자료형

### Value Type (값형)

- bool, int, uint, byte, address, enum

### Reference Type (참조형)

- 종류
    - 배열
    - 문자열
    - 구조체
    - 매핑
- Memory나 Storage에 저장

## 함수

- 함수를 정의하는 문법
    - function function-name(parameter-list) scope returns() { statements… }
- scope
    - external : contract 외부에서만 호출
    - public : 외부 또는 내부에서 호출 가능
    - private : contract 내부에서만 호출
    - view : 상태를 수정하지 않는 함수
    - pure : 상태를 참조하지 않는 함수

## Solidity 프로그램의 예: 전자 투표

- 기본 개념
    - 투표 건 수마다 하나의 contract 생성. 각 후보에 대해 간단한 이름 할당
    - Chairperson : Contract를 생성한 사람
        - 각 주소마다 투표할 권한을 부여
    - Voter : 주소에 해당하는 투표인
        - 투표하거나 혹은 투표할 권리를 다른 사람에게 위임(delegate)

# 3. web3.js

### web3.js란?

- HTTP나 WebSocket 등을 이용하여 이더리움 노드와 연동할 수 있는 JavaScript 라이브러리
- 여러 개의 모듈로 구성되며, 이더리움 블록체인 및 스마트 계약과 연동을 위하여 web3.eth 모듈 사용

### web3.eth에서 많이 사용되는 API들

- web3.eth.getBalance(address [, callback])
  • 특정 주소의 잔고를 파악
- new web3.eth.Contract(jsonInterface [, address])
  • 특정 주소에서 contract를 읽어 와서 메모리에 Contract 객체 생성
- web3.eth.getTransactionCount(address [, callback])
  • 이 주소에서 전송된 트랜잭션의 수를 반환
- web3.eth.sendSignedTransaction(signedTransactionData [, callback])
  • 개인 키로 사인한 트랜잭션을 블록체인으로 전송

---

- 블록체인 응용에서는 블록체인과 스마트 계약이 backend server의 역할을 담당한다.
- 이더리움 스마트 계약을 구현하기 위해 Solidity 언어를 사용한다.
- Solidity는 contract 기반의 high-level 언어로, contract는 함수(function)와 변수 선언으로 구성된다.
- web3.js는 이더리움 노드와 연동할 수 있는 JavaScript 라이브러리이다.